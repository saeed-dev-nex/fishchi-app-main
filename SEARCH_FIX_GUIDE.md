# ๐ ุฑุงูููุง ุฑูุน ูุดฺฉู ุฌุณุชุฌู ูุนูุง (Semantic Search)

## ๐ด ูุดฺฉูุงุช ุดูุงุณุง ุดุฏู

### 1. ุชูุงูุถ ุฏุฑ ูุงู ููุฏ Vector
**ูุดฺฉู**: ุฏุฑ ูุฏู `Source.model.js` ููุฏ vector ุจุง ูุงู `searchVector` ุชุนุฑู ุดุฏู ุจูุฏุ ุงูุง ฺฉูุชุฑูุฑ ุฌุณุชุฌู ุณุน ูโฺฉุฑุฏ ุงุฒ `contentVector` ุงุณุชูุงุฏู ฺฉูุฏ.

**ูุถุนุช**: โ **ุญู ุดุฏ** - ููุฏ ุฏุฑ `search.controller.js` ุงุตูุงุญ ุดุฏ

---

### 2. ุนุฏู ูุฌูุฏ Vector ุจุฑุง ุฏุงุฏูโูุง ููุฌูุฏ
**ูุดฺฉู**: ููุท ูุชโูุง ู ููุงุจุน ฺฉู **ุจุนุฏ ุงุฒ** ูพุงุฏูโุณุงุฒ ูุงุจูุช vector ุงุฌุงุฏ ุดุฏูโุงูุฏุ ุฏุงุฑุง vector ูุณุชูุฏ. ุฏุงุฏูโูุง ูุจู vector ูุฏุงุฑูุฏ ู ุฏุฑ ูุชุงุฌ ุฌุณุชุฌู ููุงุด ุฏุงุฏู ููโุดููุฏ.

**ุฑุงูโุญู**: ุงุฌุฑุง ุงุณฺฉุฑูพุช ุชููุฏ ุฎูุฏฺฉุงุฑ vector ุจุฑุง ุฏุงุฏูโูุง ููุฌูุฏ

---

### 3. ุขุณุชุงูู ุดุจุงูุช ุจุงูุง
**ูุดฺฉู**: ุขุณุชุงูู ุดุจุงูุช (similarity threshold) ุฑู `0.7` ุชูุธู ุดุฏู ุจูุฏ ฺฉู ุฎู ุณุฎุชโฺฏุฑุงูู ุงุณุช.

**ูุถุนุช**: โ **ุญู ุดุฏ** - ุขุณุชุงูู ุจู `0.5` ฺฉุงูุด ุงูุช

---

## ๐๏ธ ุฑุงูโุญูโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. ุงุตูุงุญ ฺฉูุชุฑูุฑ ุฌุณุชุฌู โ
ูุงู `server/src/controllers/search.controller.js` ุจูโุฑูุฒุฑุณุงู ุดุฏ:
- ุงุณุชูุงุฏู ุงุฒ `searchVector` ุจุฑุง ููุงุจุน ุจู ุฌุง `contentVector`
- ฺฉุงูุด ุขุณุชุงูู ุดุจุงูุช ุงุฒ `0.7` ุจู `0.5`

### 2. ุงุฌุงุฏ ุงุณฺฉุฑูพุช ุชููุฏ Vector โ
ูุงู `server/src/utils/generateVectors.js` ุงุฌุงุฏ ุดุฏ ฺฉู:
- ุชูุงู ูุชโูุง ู ููุงุจุน ุจุฏูู vector ุฑุง ูพุฏุง ูโฺฉูุฏ
- ุจุฑุง ูุฑ ฺฉุฏุงู embedding (vector) ุชููุฏ ูโฺฉูุฏ
- ูุถุนุช ูพุดุฑูุช ุฑุง ููุงุด ูโุฏูุฏ

---

## ๐ ูุฑุงุญู ุฑูุน ูุดฺฉู

### ูุฑุญูู 1: ุงุทููุงู ุงุฒ ุงุฌุฑุง ุณุฑูุฑ
```bash
cd server
pnpm install
pnpm dev
```

### ูุฑุญูู 2: ุงุฌุฑุง ุงุณฺฉุฑูพุช ุชููุฏ Vector
ุฏุฑ ฺฉ ุชุฑููุงู ุฌุฏุฏ:
```bash
cd server
pnpm run generate-vectors
```

**ูฺฉุชู**: ุงู ุงุณฺฉุฑูพุช ููฺฉู ุงุณุช ุจุณุชู ุจู ุชุนุฏุงุฏ ูุชโูุง ู ููุงุจุน ุดูุง ู ูุญุฏูุฏุชโูุง API ููุด ูุตููุนุ ฺูุฏ ุฏููู ุทูู ุจฺฉุดุฏ.

ุฎุฑูุฌ ูุซุงู:
```
๐ ุดุฑูุน ุชููุฏ vector ุจุฑุง ุฏุงุฏูโูุง ููุฌูุฏ...

๐ 15 ูุช ุจุฏูู vector ูพุฏุง ุดุฏ.

   โณ ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ูุช 673f5a1b2c3d4e5f6a7b8c9d...
   โ ูุช 673f5a1b2c3d4e5f6a7b8c9d ุจุง ููููุช ุขูพุฏุช ุดุฏ
   ...

โ ูุชโูุง: 15 ููููุ 0 ูุงูููู

๐ 8 ููุจุน ุจุฏูู vector ูพุฏุง ุดุฏ.

   โณ ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ููุจุน 673f5a1b2c3d4e5f6a7b8c9e...
   โ ููุจุน 673f5a1b2c3d4e5f6a7b8c9e ุจุง ููููุช ุขูพุฏุช ุดุฏ
   ...

โ ููุงุจุน: 8 ููููุ 0 ูุงูููู

๐ ุนููุงุช ุชููุฏ vector ุจุง ููููุช ุจู ูพุงุงู ุฑุณุฏ!
๐ ูุฌููุน: 23 ููููุ 0 ูุงูููู
```

### ูุฑุญูู 3: ุชุณุช ุฌุณุชุฌู
1. ุจุฑูุงูู ูุฑุงูุชโุงูุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏ:
```bash
cd client
pnpm dev
```

2. ุฏุฑ ุตูุญู ุงุตู ุง ูุฑ ุตูุญูโุง ฺฉู SearchBox ุฏุงุฑุฏุ ุนุจุงุฑุช ุฑุง ุฌุณุชุฌู ฺฉูุฏ
3. ุจุงุฏ ูุชุงุฌ ูุฑุชุจุท ุฑุง ูุดุงูุฏู ฺฉูุฏ

---

## ๐ ูุญูู ฺฉุงุฑ ุณุณุชู ุฌุณุชุฌู

### ูุฑุขูุฏ ุฌุณุชุฌู ูุนูุง:
1. **ูุฑูุฏ ฺฉุงุฑุจุฑ**: ฺฉุงุฑุจุฑ ุนุจุงุฑุช ุฑุง ุฏุฑ SearchBox ูุงุฑุฏ ูโฺฉูุฏ
2. **ุชููุฏ Vector**: ุนุจุงุฑุช ุฌุณุชุฌู ุจู ฺฉ vector ุนุฏุฏ ุชุจุฏู ูโุดูุฏ (ุจุง API Google Gemini)
3. **ููุงุณู**: ุงู vector ุจุง ุชูุงู vector ูุง ูุชโูุง ู ููุงุจุน ููุงุณู ูโุดูุฏ
4. **ูุญุงุณุจู ุดุจุงูุช**: ุจุง ุงุณุชูุงุฏู ุงุฒ Cosine Similarity ูุฒุงู ุดุจุงูุช ูุญุงุณุจู ูโุดูุฏ
5. **ููุชุฑ**: ููุท ููุงุฑุฏ ุจุง ุดุจุงูุช ุจุงูุงุชุฑ ุงุฒ 0.5 ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ
6. **ูุฑุชุจโุณุงุฒ**: ูุชุงุฌ ุจุฑ ุงุณุงุณ ุจุดุชุฑู ุดุจุงูุช ูุฑุชุจ ูโุดููุฏ

### ูุฒุช ุฌุณุชุฌู ูุนูุง ูุณุจุช ุจู ุฌุณุชุฌู ูุชู:
- โ ุฏุฑฺฉ **ูุนูุง** ู **ููููู** ุนุจุงุฑุชุ ูู ููุท ฺฉููุงุช
- โ ุงูุชู ูุชุงุฌ **ูุฑุชุจุท** ุญุช ุจุง ฺฉููุงุช ูุชูุงูุช
- โ ูพุดุชุจุงู ุงุฒ **ุฒุจุงู ูุงุฑุณ** ู **ุงูฺฏูุณ**
- โ ุฌุณุชุฌู ููุดููุฏ ุจุฑ ุงุณุงุณ **ูุญุชูุง** ูู ููุท ุนููุงู

---

## โ๏ธ ุชูุธูุงุช ูุงุจู ุชุบุฑ

### ุชุบุฑ ุขุณุชุงูู ุดุจุงูุช
ูุงู: `server/src/controllers/search.controller.js`

```javascript
// ุฎุท 45 ู 54
if (similarity > 0.5) {  // ููุฏุงุฑ ูุงุจู ุชูุธู
```

**ุชูุตู**:
- `0.3-0.4`: ูุชุงุฌ ุฒุงุฏุ ููฺฉู ุงุณุช ุบุฑูุฑุชุจุท ุจุงุดูุฏ
- `0.5-0.6`: โ **ุชูุตู ูโุดูุฏ** - ุชุนุงุฏู ุฎูุจ ุจู ุชุนุฏุงุฏ ู ุฏูุช
- `0.7-0.8`: ูุชุงุฌ ฺฉูุ ููุท ููุงุฑุฏ ุจุณุงุฑ ูุฑุชุจุท
- `0.9+`: ููุท ููุงุฑุฏ ุชูุฑุจุงู ฺฉุณุงู

---

## ๐จ ุนุจโุงุจ (Troubleshooting)

### ูุดฺฉู: ูฺ ูุชุฌูโุง ุจุฑฺฏุฑุฏุงูุฏู ููโุดูุฏ
**ุฑุงูโุญูโูุง ุงุญุชูุงู**:
1. โ ุงุณฺฉุฑูพุช `generate-vectors` ุฑุง ุงุฌุฑุง ฺฉูุฏ
2. โ ูุทูุฆู ุดูุฏ API Key ููุด ูุตููุน (Gemini) ุฏุฑ `.env` ุชูุธู ุดุฏู
3. โ ูุงฺฏโูุง ฺฉูุณูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
4. โ ุขุณุชุงูู ุดุจุงูุช ุฑุง ฺฉุงูุด ุฏูุฏ (ูุซูุงู ุจู 0.3)

### ูุดฺฉู: ุฎุทุง "Failed to generate embedding"
**ุฑุงูโุญูโูุง ุงุญุชูุงู**:
1. โ API Key ฺฏูฺฏู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. โ ุงุชุตุงู ุงูุชุฑูุช ุฑุง ฺฺฉ ฺฉูุฏ
3. โ ูุญุฏูุฏุชโูุง API (rate limit) ุฑุง ุจุฑุฑุณ ฺฉูุฏ

### ูุดฺฉู: ุฌุณุชุฌู ุฎู ฺฉูุฏ ุงุณุช
**ุฑุงูโุญูโูุง ุงุญุชูุงู**:
1. โ๏ธ ุงู ุฑูุด ุจุฑุง ุฏุชุงุจุณโูุง ุจุฒุฑฺฏ ฺฉูุฏ ุงุณุช
2. ๐ก ุจุฑุง productionุ ุงุฒ MongoDB Atlas Vector Search ุงุณุชูุงุฏู ฺฉูุฏ
3. ๐ก ุง ุงุฒ ุณุฑูุณโูุง ุชุฎุตุต ูุซู Pineconeุ Qdrant ุงุณุชูุงุฏู ฺฉูุฏ

---

## ๐ ุจุฑุฑุณ ูุถุนุช Vector ูุง

ุจุฑุง ุจุฑุฑุณ ุงูฺฉู ฺูุฏ ูุช/ููุจุน ุฏุงุฑุง vector ูุณุชูุฏุ ูโุชูุงูุฏ ุงู query ุฑุง ุฏุฑ MongoDB Compass ุง mongosh ุงุฌุฑุง ฺฉูุฏ:

```javascript
// ุชุนุฏุงุฏ ูุชโูุง ุฏุงุฑุง vector
db.notes.countDocuments({ vectorGenerated: true })

// ุชุนุฏุงุฏ ููุงุจุน ุฏุงุฑุง vector
db.sources.countDocuments({ vectorGenerated: true })

// ุชุนุฏุงุฏ ฺฉู ูุชโูุง
db.notes.countDocuments()

// ุชุนุฏุงุฏ ฺฉู ููุงุจุน
db.sources.countDocuments()
```

---

## ๐ ูฺฉุงุช ููู

1. **Vector ูุง ุฎูุฏฺฉุงุฑ ุชููุฏ ูโุดููุฏ**: ุจุฑุง ูุชโูุง ู ููุงุจุน ุฌุฏุฏุ vector ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ูพุณโุฒููู ุชููุฏ ูโุดูุฏ (ุจุง post-save hook)

2. **API Rate Limits**: ุณุฑูุณ Gemini ูุญุฏูุฏุช ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุช ุฏุงุฑุฏ. ุงฺฏุฑ ุฏุงุฏู ุฒุงุฏ ุฏุงุฑุฏุ ููฺฉู ุงุณุช ูุงุฒ ุจู ูููู ุจู ุฏุฑุฎูุงุณุชโูุง ุจุงุดุฏ

3. **ูุตุฑู ูุถุง**: ูุฑ vector ุญุฏูุฏ 768 ุนุฏุฏ float ุงุณุช. ุจุฑุง ุฏุชุงุจุณโูุง ุจุฒุฑฺฏุ ุงู ุญุฌู ูุงุจู ุชูุฌู ูโุดูุฏ

4. **ุขูพุฏุช ูุญุชูุง**: ุงฺฏุฑ ูุญุชูุง ูุช ุง ููุจุน ุฑุง ุชุบุฑ ุฏูุฏุ vector ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏูุจุงุฑู ุชููุฏ ูโุดูุฏ

---

## ๐ฏ ฺฺฉโูุณุช ููุง

- [ ] ฺฉุฏ ฺฉูุชุฑูุฑ ุฌุณุชุฌู ุงุตูุงุญ ุดุฏ (ุงุณุชูุงุฏู ุงุฒ searchVector ุจุฑุง ููุงุจุน)
- [ ] ุขุณุชุงูู ุดุจุงูุช ุจู 0.5 ฺฉุงูุด ุงูุช
- [ ] ุงุณฺฉุฑูพุช generate-vectors ุงุฌุฑุง ุดุฏ
- [ ] ุชูุงู ูุชโูุง ู ููุงุจุน ุฏุงุฑุง vector ุดุฏูุฏ (vectorGenerated: true)
- [ ] ุฌุณุชุฌู ุฏุฑ ูุฑุงูุชโุงูุฏ ุชุณุช ุดุฏ
- [ ] ูุชุงุฌ ูุฑุชุจุท ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ

---

## ๐ ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ฺฉูฺฉ

ุงฺฏุฑ ุจุงุฒ ูู ูุดฺฉู ูุฌูุฏ ุฏุงุดุช:
1. ูุงฺฏโูุง console ุฑุง ุจุฑุฑุณ ฺฉูุฏ (ูู ูุฑุงูุช ู ูู ุจฺฉโุงูุฏ)
2. Network tab ุฏุฑ DevTools ูุฑูุฑฺฏุฑ ุฑุง ฺฺฉ ฺฉูุฏ
3. ูุทูุฆู ุดูุฏ ฺฉู route ูุง API ุจู ุฏุฑุณุช register ุดุฏูโุงูุฏ
4. ุชุณุชโูุง API ุฑุง ุจุง Postman ุง curl ุงูุฌุงู ุฏูุฏ

---

**ุชุงุฑุฎ ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู**: 20 ุงฺฉุชุจุฑ 2025
**ูุณุฎู**: 1.0.0
