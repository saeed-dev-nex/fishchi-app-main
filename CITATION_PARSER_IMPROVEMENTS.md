# ุจูุจูุฏ Citation Parser - ูพุดุชุจุงู ฺฉุงูู ุงุฒ ูุงูโูุง ูุงุฑุณ

## ๐ ุฎูุงุตู ุชุบุฑุงุช

ุงู ุจุฑูุฒุฑุณุงู ูุดฺฉู ุงุณุชุฎุฑุงุฌ ูุงุฏุฑุณุช ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ููุณูุฏฺฏุงู ูุงุฑุณ ุฏุฑ ุจุฎุด "Parse Citation" ุฑุง ุจุฑุทุฑู ูโฺฉูุฏ.

## โ ูุดฺฉู ูุจู

ุฏุฑ ูุณุฎู ูุจูุ ุงุณุชุฎุฑุงุฌ ูุงูโูุง ููุณูุฏฺฏุงู ูุงุฑุณ ุจู ุฏุฑุณุช ฺฉุงุฑ ููโฺฉุฑุฏ ุฒุฑุง:

1. ุงูฺฏูุฑุชู ุจู ุฏุฑุณุช ูุฑูุช ูุงุฑุณ `"ูุงู ุฎุงููุงุฏฺฏุ ูุงู"` ุฑุง ุชุดุฎุต ููโุฏุงุฏ
2. ูุงูโูุง ฺูุฏ ฺฉูููโุง (ูุซู "ูุณู ุฎูุงู") ุจู ุฏุฑุณุช parse ููโุดุฏูุฏ
3. ุชุฑุชุจ ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ุฏุฑ citation ูุง ูุงุฑุณ ุจุฑุนฺฉุณ ููุงุด ุฏุงุฏู ูโุดุฏ

### ูุซุงู Citation ูุงุฑุณ:

```
ุฑุจุนุ ููุงุ ูุณู ุฎูุงูุ ุณุงุฑุงุ ฺฏุฑุฒูุ ุณุงุฑุงุ ูุงุฒูฺุ ูุฌุชุจุ ุญุณูุ ุชุงูุง.
ุจุฑุฑุณ ุฌุงูุนู ุดูุงุฎุช ููุงุฑ ุขููุงู ุฏุฑ ุดุจฺฉู ูุง ุงุฌุชูุงุน.
ุจุฑุฑุณโูุง ูุฏุฑุช ุฑุณุงูู[Internet]. 1401ุ1(1):78-101.
```

## โ ุฑุงูโุญู ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. ุงุฌุงุฏ Persian Name Processor Utility

**ูุงู:** `client/src/utils/persianNameProcessor.ts`

ุงู utility ุดุงูู ุชูุงุจุน ุฒุฑ ุงุณุช:

#### `parseAuthors(authorText: string): Author[]`

- ุงุณุชุฎุฑุงุฌ ุฎูุฏฺฉุงุฑ ูุงูโูุง ูุงุฑุณ ู ุงูฺฏูุณ
- ุชุดุฎุต ุฒุจุงู ุจุฑ ุงุณุงุณ ฺฉุงุฑุงฺฉุชุฑูุง ูุงุฑุณ
- ูพุดุชุจุงู ุงุฒ ูุฑูุชโูุง ูุฎุชูู citation (APA, Chicago, Vancouver, etc.)

**ูุฑูุชโูุง ูพุดุชุจุงู ุดุฏู:**

**ูุงุฑุณ:**

- `"ูุงู ุฎุงููุงุฏฺฏุ ูุงู"` โ `{ firstname: "ูุงู", lastname: "ูุงู ุฎุงููุงุฏฺฏ" }`
- ูุซุงู: `"ุฑุจุนุ ููุง"` โ `{ firstname: "ููุง", lastname: "ุฑุจุน" }`
- ูพุดุชุจุงู ุงุฒ ูุงูโูุง ฺูุฏ ฺฉูููโุง: `"ูุณู ุฎูุงูุ ุณุงุฑุง"`

**ุงูฺฏูุณ:**

- `"Lastname, Firstname"` (APA, Chicago)
- `"Lastname F."` (ูุฎูู)
- `"Firstname Lastname"`

#### `formatAuthors(authors: Author[]): string`

- ูุฑูุช ฺฉุฑุฏู ูุงูโูุง ุจุฑุง ููุงุด: `"ูุงู ูุงู ุฎุงููุงุฏฺฏ"`
- ูุซุงู: `"ููุง ุฑุจุน, ุณุงุฑุง ูุณู ุฎูุงู"`

#### `formatAuthorsForCitation(authors: Author[]): string`

- ูุฑูุช ฺฉุฑุฏู ูุงูโูุง ุจุฑุง citation: `"ูุงู ุฎุงููุงุฏฺฏุ ูุงู"`
- ุญูุธ ูุฑูุช ุงุณุชุงูุฏุงุฑุฏ citation

### 2. ุจูุจูุฏ Backend Citation Parser

**ูุงู:** `server/src/utils/citationParser.js`

**ุชุบุฑุงุช ุฏุฑ ุชุงุจุน `extractAuthors`:**

```javascript
// ุงูฺฏูุฑุชู ุฌุฏุฏ ุจุฑุง ูุงุฑุณ
const persianAuthorPattern = /([ุข-\s]+?)ุ\s*([ุข-\s]+?)(?=ุ|,|$|ู)/g;
```

**ูฺฺฏโูุง ุฌุฏุฏ:**

- โ ุชุดุฎุต ูุงูโูุง ฺูุฏ ฺฉูููโุง (ูุซู "ูุณู ุฎูุงู")
- โ ุชูุฒ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ conjunction "ู"
- โ Normalize ฺฉุฑุฏู ูุงุตููโูุง
- โ ูพุดุชุจุงู ุงุฒ ุงูฺฏูุฑุชู fallback ุจุฑุง ูุฑูุชโูุง ุบุฑุงุณุชุงูุฏุงุฑุฏ

### 3. ุจุฑูุฒุฑุณุงู AddSourceModal.tsx

**ูุงู:** `client/src/components/sources/AddSourceModal.tsx`

**ุชุบุฑุงุช:**

1. **Import utility ุฌุฏุฏ:**

```typescript
import { parseAuthors, formatAuthors } from '../../utils/persianNameProcessor';
```

2. **ุงุณุชูุงุฏู ุฏุฑ `handleParseCitation`:**

```typescript
setValue(
  'authors',
  parsedData.authors && parsedData.authors.length > 0
    ? formatAuthors(parsedData.authors)
    : ''
);
```

3. **ุงุณุชูุงุฏู ุฏุฑ `onManualSubmit`:**

```typescript
authors: data.authors ? parseAuthors(data.authors) : [],
```

## ๐งช ุชุณุช

ุจุฑุง ุชุณุช ุชุบุฑุงุช backend:

```bash
cd server
node src/utils/citationParser.test.js
```

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**

```
--- Test 1: Persian Citation - Multiple Authors ---
โ Parsed Successfully: true
Detected Format: apa
Language: persian

Extracted Authors:
  1. ููุง ุฑุจุน
  2. ุณุงุฑุง ูุณู ุฎูุงู
  3. ุณุงุฑุง ฺฏุฑุฒู
  4. ูุฌุชุจ ูุงุฒูฺ
  5. ุชุงูุง ุญุณู

โ Author count matches!
```

## ๐ ูุฑูุชโูุง Citation ูพุดุชุจุงู ุดุฏู

| ูุฑูุช          | ูุงุฑุณ | ุงูฺฏูุณ | ูุซุงู                                  |
| ------------- | ----- | ------- | ------------------------------------- |
| **APA**       | โ    | โ      | `ุฑุจุนุ ููุง. (1401). ุนููุงู. ูุฌูู...` |
| **Chicago**   | โ    | โ      | `ุฑุจุนุ ููุง. "ุนููุงู." ูุฌูู...`       |
| **Vancouver** | โ    | โ      | `1. ุฑุจุนุ ููุง. ุนููุงู. ูุฌูู...`      |
| **MLA**       | โ    | โ      | `ุฑุจุนุ ููุง. "ุนููุงู." ูุฌูู...`       |
| **Harvard**   | โ    | โ      | `ุฑุจุนุ ููุง 1401, "ุนููุงู"...`        |

## ๐ ูููููโูุง ุชุณุช ุดุฏู

### โ ููููู 1: Citation ูุงุฑุณ ุจุง 5 ููุณูุฏู

```
ุฑุจุนุ ููุงุ ูุณู ุฎูุงูุ ุณุงุฑุงุ ฺฏุฑุฒูุ ุณุงุฑุงุ ูุงุฒูฺุ ูุฌุชุจุ ุญุณูุ ุชุงูุง.
ุจุฑุฑุณ ุฌุงูุนู ุดูุงุฎุช ููุงุฑ ุขููุงู ุฏุฑ ุดุจฺฉู ูุง ุงุฌุชูุงุน.
ุจุฑุฑุณโูุง ูุฏุฑุช ุฑุณุงูู[Internet]. 1401ุ1(1):78-101.
```

**ูุชุฌู:**

- โ 5 ููุณูุฏู ุงุณุชุฎุฑุงุฌ ุดุฏ
- โ ูุงูโูุง ฺูุฏ ฺฉูููโุง ("ูุณู ุฎูุงู") ุจู ุฏุฑุณุช parse ุดุฏ
- โ ุชุฑุชุจ ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ุตุญุญ ุงุณุช

### โ ููููู 2: Citation ูุงุฑุณ ุณุงุฏู

```
ูุตุฑุ ุณุงุฑุงุ ุญุณู ุฒุงุฏูุ ุงุณูุงุนู. (1396). ุนููุงู ููุงูู...
```

**ูุชุฌู:**

- โ 2 ููุณูุฏู ุงุณุชุฎุฑุงุฌ ุดุฏ
- โ ูุงู ุฎุงููุงุฏฺฏ ฺูุฏ ฺฉูููโุง ("ุญุณู ุฒุงุฏู") ุจู ุฏุฑุณุช parse ุดุฏ

### โ ููููู 3: Citation ุงูฺฏูุณ APA

```
Smith, J., & Johnson, M. (2024). The impact of technology...
```

**ูุชุฌู:**

- โ 2 ููุณูุฏู ุงุณุชุฎุฑุงุฌ ุดุฏ
- โ ูุงูโูุง ูุฎูู ุจู ุฏุฑุณุช parse ุดุฏูุฏ

## ๐ ุงุณุชูุงุฏู

### ุฏุฑ ููุฏุงู ุงูุฒูุฏู ููุจุน:

1. **Tab "Parse Citation"** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
2. ูุชู citation ุฑุง paste ฺฉูุฏ (ูุงุฑุณ ุง ุงูฺฏูุณ)
3. ุฏฺฉูู **"ุงุณุชุฎุฑุงุฌ ุงุทูุงุนุงุช"** ุฑุง ุจุฒูุฏ
4. ุงุทูุงุนุงุช ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ูุฑู ุฏุณุช ูพุฑ ูโุดูุฏ
5. ุงุทูุงุนุงุช ููุณูุฏฺฏุงู ุจู ูุฑูุช ุตุญุญ ููุงุด ุฏุงุฏู ูโุดูุฏ:
   - ูุงุฑุณ: `"ููุง ุฑุจุน, ุณุงุฑุง ูุณู ุฎูุงู"`
   - ุงูฺฏูุณ: `"John Smith, Mary Johnson"`

## ๐ ูฺฉุงุช ููู

### ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู:

1. **ููุดู ุงุฒ `parseAuthors()` ุงุณุชูุงุฏู ฺฉูุฏ** ุจุฑุง parse ฺฉุฑุฏู ูุงูโูุง ููุณูุฏฺฏุงู
2. **ุงุฒ `formatAuthors()` ุงุณุชูุงุฏู ฺฉูุฏ** ุจุฑุง ููุงุด ูุงูโูุง ุฏุฑ UI
3. **ุงุฒ `formatAuthorsForCitation()` ุงุณุชูุงุฏู ฺฉูุฏ** ุจุฑุง ุฐุฎุฑู ุฏุฑ ูุฑูุช citation

### ุจุฑุง ฺฉุงุฑุจุฑุงู:

1. Citation ูุง ุจุงุฏ ุฏุฑ ูุฑูุช ุงุณุชุงูุฏุงุฑุฏ (APA, Chicago, etc.) ุจุงุดูุฏ
2. ูุงูโูุง ูุงุฑุณ ุจุงุฏ ุจุง ูุฑูุช `"ูุงู ุฎุงููุงุฏฺฏุ ูุงู"` ุจุงุดูุฏ
3. ุจุฑุง ุฌุฏุง ฺฉุฑุฏู ููุณูุฏฺฏุงู ุงุฒ ฺฉุงูุง (ุ) ุง "ู" ุงุณุชูุงุฏู ฺฉูุฏ

## ๐ ูุดฺฉูุงุช ุจุฑุทุฑู ุดุฏู

- โ ูุงูโูุง ูุงุฑุณ ุจู ุฏุฑุณุช parse ูโุดููุฏ
- โ ุชุฑุชุจ ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ุตุญุญ ุงุณุช
- โ ูุงูโูุง ฺูุฏ ฺฉูููโุง ูพุดุชุจุงู ูโุดููุฏ
- โ ฺฉุงุฑุงฺฉุชุฑูุง ุฎุงุต ู conjunction ูุง ุจู ุฏุฑุณุช handle ูโุดููุฏ
- โ ูู ูุงุฑุณ ู ูู ุงูฺฏูุณ ุจู ุฏุฑุณุช ฺฉุงุฑ ูโฺฉููุฏ

## ๐ ูุณุชูุฏุงุช API

### TypeScript Types

```typescript
interface Author {
  firstname: string;
  lastname: string;
}

// Parse author string to Author objects
parseAuthors(authorText: string): Author[]

// Format authors for display
formatAuthors(authors: Author[]): string

// Format authors for citation storage
formatAuthorsForCitation(authors: Author[]): string
```

## ๐ ููุงุณู ูุจู ู ุจุนุฏ

| ูฺฺฏ                  | ูุจู       | ุจุนุฏ     |
| ---------------------- | --------- | ------- |
| Parse ูุงู ูุงุฑุณ        | โ ูุงุฏุฑุณุช | โ ุตุญุญ |
| ูุงู ฺูุฏ ฺฉูููโุง        | โ        | โ      |
| ุชุฑุชุจ ูุงู/ูุงู ุฎุงููุงุฏฺฏ | โ ุจุฑุนฺฉุณ  | โ ุตุญุญ |
| ูพุดุชุจุงู ุงุฒ "ู"        | โ        | โ      |
| ูุฑูุชโูุง ูุฎุชูู         | โ๏ธ ูุญุฏูุฏ  | โ ฺฉุงูู |

## ๐ฏ ูุชุฌู

ุจุง ุงู ุจุฑูุฒุฑุณุงู:

- โ ุงุณุชุฎุฑุงุฌ ูุงูโูุง ูุงุฑุณ **100% ุจูุจูุฏ ุงูุชู**
- โ ุณุงุฒฺฏุงุฑ ฺฉุงูู ุจุง ูุฑูุชโูุง citation ุงุณุชุงูุฏุงุฑุฏ
- โ ฺฉุฏ ุชูุฒุ ูุงุจู ูฺฏูุฏุงุฑ ู ูุงุจู ุชูุณุนู
- โ ูพูุดุด ุชุณุช ฺฉุงูู
